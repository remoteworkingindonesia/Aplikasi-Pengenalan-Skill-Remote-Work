<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RWI Skill Discovery Tool - Remote Working Indonesia</title>
  
  <!-- Meta tags for embedding -->
  <meta name="description" content="Temukan skill tersembunyi Anda untuk memulai karir remote working dengan assessment AI dari Remote Working Indonesia">
  <meta name="keywords" content="remote work, skill assessment, indonesia, remote working, skill discovery">
  <meta name="author" content="Remote Working Indonesia">
  
  <!-- Open Graph tags for social sharing -->
  <meta property="og:title" content="RWI Skill Discovery Tool">
  <meta property="og:description" content="Temukan skill tersembunyi Anda untuk memulai karir remote working">
  <meta property="og:type" content="website">
  <meta property="og:url" content="">
  <meta property="og:image" content="">
  
  <!-- Twitter Card tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="RWI Skill Discovery Tool">
  <meta name="twitter:description" content="Temukan skill tersembunyi Anda untuk memulai karir remote working">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üöÄ</text></svg>">
  
  <!-- Prevent iframe embedding restrictions -->
  <meta http-equiv="Content-Security-Policy" content="frame-ancestors *;">
  
  <!-- CSS Imports -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- React and ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Babel for JSX transformation -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Additional libraries -->
  <script src="https://cdn.jsdelivr.net/npm/lucide-react@latest/dist/umd/lucide-react.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3.2.0/dist/email.min.js"></script>
  
  <style>
    /* Import our custom CSS */
    @import url('./styles/globals.css');
    
    /* Additional styles for embedding */
    * {
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      line-height: 1.6;
      color: #333;
      background: linear-gradient(135deg, #eff6ff 0%, #e0e7ff 100%);
      min-height: 100vh;
    }
    
    /* Ensure proper iframe sizing */
    html, body, #root {
      height: 100%;
      width: 100%;
    }
    
    /* Custom scrollbar for better UX */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
    
    /* Loading animation */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
      gap: 1rem;
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Responsive embedding */
    .embed-container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
    }
    
    /* Print styles */
    @media print {
      body {
        background: white !important;
      }
    }
    
    /* Embedding optimizations */
    .iframe-optimized {
      overflow-x: hidden;
      padding: 0.5rem;
    }
    
    /* Mobile optimizations for embedding */
    @media (max-width: 768px) {
      .embed-container {
        padding: 0.5rem;
      }
      
      body {
        font-size: 14px;
      }
    }
  </style>
  
  <!-- Tailwind configuration for our custom design system -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            background: 'var(--background)',
            foreground: 'var(--foreground)',
            card: 'var(--card)',
            'card-foreground': 'var(--card-foreground)',
            popover: 'var(--popover)',
            'popover-foreground': 'var(--popover-foreground)',
            primary: 'var(--primary)',
            'primary-foreground': 'var(--primary-foreground)',
            secondary: 'var(--secondary)',
            'secondary-foreground': 'var(--secondary-foreground)',
            muted: 'var(--muted)',
            'muted-foreground': 'var(--muted-foreground)',
            accent: 'var(--accent)',
            'accent-foreground': 'var(--accent-foreground)',
            destructive: 'var(--destructive)',
            'destructive-foreground': 'var(--destructive-foreground)',
            border: 'var(--border)',
            input: 'var(--input)',
            ring: 'var(--ring)',
          }
        }
      }
    }
  </script>
</head>

<body>
  <!-- Loading screen -->
  <div id="loading-screen" class="loading">
    <div class="spinner"></div>
    <p>Loading RWI Skill Discovery Tool...</p>
    <p class="text-sm text-gray-600">Memuat assessment tool...</p>
  </div>

  <!-- Main application container -->
  <div id="root" style="display: none;"></div>

  <!-- Error fallback -->
  <div id="error-fallback" style="display: none;" class="flex items-center justify-center min-h-screen bg-red-50">
    <div class="text-center p-8 max-w-md mx-auto">
      <div class="text-6xl mb-4">‚ùå</div>
      <h2 class="text-xl font-semibold text-red-700 mb-2">Oops! Something went wrong</h2>
      <p class="text-red-600 mb-4">The assessment tool failed to load. Please try refreshing the page.</p>
      <button onclick="window.location.reload()" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
        üîÑ Refresh Page
      </button>
      <div class="mt-4 text-sm text-gray-600">
        <p>If the problem persists, please contact:</p>
        <a href="mailto:remoteworkingindonesia@gmail.com" class="text-blue-600 hover:underline">
          remoteworkingindonesia@gmail.com
        </a>
      </div>
    </div>
  </div>

  <!-- Analytics and tracking (optional) -->
  <script>
    // Basic analytics for embedded usage
    const trackEmbedUsage = () => {
      try {
        const isEmbedded = window.self !== window.top;
        const referrer = document.referrer;
        const timestamp = new Date().toISOString();
        
        // Store basic usage analytics in localStorage
        const usage = JSON.parse(localStorage.getItem('rwi_embed_analytics') || '[]');
        usage.push({
          timestamp,
          isEmbedded,
          referrer,
          userAgent: navigator.userAgent,
          url: window.location.href
        });
        
        // Keep only last 100 entries
        if (usage.length > 100) {
          usage.splice(0, usage.length - 100);
        }
        
        localStorage.setItem('rwi_embed_analytics', JSON.stringify(usage));
      } catch (error) {
        console.log('Analytics tracking failed:', error);
      }
    };
    
    // Track when embedded
    document.addEventListener('DOMContentLoaded', trackEmbedUsage);
  </script>

  <!-- Main application script -->
  <script type="text/babel">
    // Error boundary component
    class ErrorBoundary extends React.Component {
      constructor(props) {
        super(props);
        this.state = { hasError: false, error: null };
      }

      static getDerivedStateFromError(error) {
        return { hasError: true, error };
      }

      componentDidCatch(error, errorInfo) {
        console.error('RWI Assessment Error:', error, errorInfo);
        
        // Hide loading screen and show error
        document.getElementById('loading-screen').style.display = 'none';
        document.getElementById('error-fallback').style.display = 'flex';
        document.getElementById('root').style.display = 'none';
      }

      render() {
        if (this.state.hasError) {
          return null; // Error fallback is shown via DOM manipulation
        }

        return this.props.children;
      }
    }

    // Main App component (simplified for embedding)
    const EmbeddableApp = () => {
      const [isLoading, setIsLoading] = React.useState(true);
      const [error, setError] = React.useState(null);

      React.useEffect(() => {
        // Simulate loading and initialization
        const initializeApp = async () => {
          try {
            // Check if we're in an iframe
            const isEmbedded = window.self !== window.top;
            
            // Add body class for embedded styling
            if (isEmbedded) {
              document.body.classList.add('iframe-optimized');
            }
            
            // Initialize EmailJS if available
            if (window.emailjs) {
              window.emailjs.init('rJe5vyTH9dqcMeYQI');
            }
            
            // Simulate initialization delay
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            setIsLoading(false);
            
            // Show the app and hide loading screen
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('root').style.display = 'block';
            
          } catch (err) {
            console.error('Initialization error:', err);
            setError(err);
            setIsLoading(false);
          }
        };

        initializeApp();
      }, []);

      if (isLoading) {
        return null; // Loading screen is shown via HTML
      }

      if (error) {
        return (
          <div className="flex items-center justify-center min-h-screen bg-red-50 p-4">
            <div className="text-center max-w-md">
              <div className="text-4xl mb-4">üö®</div>
              <h2 className="text-lg font-semibold text-red-700 mb-2">
                Failed to Load Assessment
              </h2>
              <p className="text-red-600 text-sm mb-4">
                {error.message || 'An unexpected error occurred'}
              </p>
              <button 
                onClick={() => window.location.reload()}
                className="bg-red-600 text-white px-4 py-2 rounded text-sm hover:bg-red-700"
              >
                Try Again
              </button>
            </div>
          </div>
        );
      }

      // Placeholder for the actual React app
      return (
        <div className="embed-container">
          <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
            <div className="container mx-auto px-4 py-8">
              {/* Header */}
              <header className="text-center mb-8">
                <div className="inline-flex items-center gap-3 mb-4">
                  <div className="w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center text-2xl">
                    üöÄ
                  </div>
                  <div className="text-left">
                    <h1 className="text-2xl font-bold text-gray-900">
                      Skill Discovery Tool
                    </h1>
                    <p className="text-sm text-blue-600 font-medium">
                      Remote Working Indonesia
                    </p>
                  </div>
                </div>
              </header>

              {/* Welcome Content */}
              <main className="text-center space-y-8 max-w-2xl mx-auto">
                <div className="space-y-4">
                  <p className="text-lg leading-relaxed">
                    Selamat datang di <strong>Skill Discovery Tool</strong> dari Remote Working Indonesia! 
                    Tool ini akan membantu Anda mengenali skill tersembunyi yang mungkin belum Anda sadari 
                    untuk memulai karir remote working.
                  </p>
                  
                  <div className="bg-blue-50 p-6 rounded-lg text-left">
                    <h3 className="font-medium text-blue-700 mb-3">üéØ Apa yang akan Anda dapatkan:</h3>
                    <ul className="space-y-2 text-blue-600">
                      <li>‚Ä¢ Identifikasi skill tersembunyi</li>
                      <li>‚Ä¢ Rekomendasi jenis pekerjaan remote yang cocok</li>
                      <li>‚Ä¢ Analisis tipe remote work yang sesuai</li>
                      <li>‚Ä¢ Analisis time zone optimal untuk pencarian kerja</li>
                      <li>‚Ä¢ Langkah konkret untuk memulai karir remote</li>
                      <li>‚Ä¢ Laporan lengkap dalam format PDF</li>
                      <li>‚Ä¢ Email hasil assessment dan newsletter RWI</li>
                    </ul>
                  </div>

                  <div className="bg-yellow-50 p-4 rounded-lg">
                    <p className="text-yellow-700 text-sm">
                      <strong>üí° Tips:</strong> Jawab pertanyaan dengan jujur dan detail. 
                      Tool ini mencakup berbagai bidang termasuk engineering, teknik, dan profesi lainnya.
                      Semakin lengkap informasi yang Anda berikan, semakin akurat rekomendasi yang akan diberikan.
                    </p>
                  </div>

                  <div className="bg-green-50 p-4 rounded-lg">
                    <p className="text-green-700 text-sm">
                      <strong>üìß Bonus:</strong> Setelah assessment, Anda akan mendapatkan hasil via email 
                      dan bisa bergabung dengan newsletter RWI untuk tips remote work terbaru!
                    </p>
                  </div>
                </div>

                <div className="space-y-4">
                  <a 
                    href="./App.tsx" 
                    className="inline-block bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-lg text-lg font-medium transition-colors no-underline"
                    onClick={(e) => {
                      e.preventDefault();
                      // In a real implementation, this would navigate to the full app
                      alert('üöÄ Dalam implementasi penuh, ini akan memulai assessment lengkap!\n\nUntuk menggunakan aplikasi lengkap, silakan akses melalui domain utama atau host lokal Anda.');
                    }}
                  >
                    üöÄ Mulai Assessment
                  </a>
                  
                  <p className="text-sm text-gray-600">
                    Assessment membutuhkan waktu sekitar 5-10 menit untuk diselesaikan
                  </p>
                  
                  <div className="text-xs text-gray-500 mt-4 p-3 bg-gray-50 rounded">
                    <p><strong>üìå Embedded Mode:</strong> Anda sedang melihat versi embeddable.</p>
                    <p>Untuk akses penuh, kunjungi: <span className="font-mono">https://your-domain.com</span></p>
                  </div>
                </div>
              </main>

              {/* Footer */}
              <footer className="mt-16 text-center text-sm text-gray-600 border-t pt-8">
                <p>
                  ¬© 2025 Remote Working Indonesia. 
                  <span className="mx-2">‚Ä¢</span>
                  <a href="mailto:remoteworkingindonesia@gmail.com" className="hover:text-blue-600">
                    Contact Us
                  </a>
                </p>
                <p className="mt-2">
                  Semangat Lokal, Ruang Kerja Global üáÆüá©
                </p>
                <div className="mt-4 space-x-4">
                  <a 
                    href="https://www.instagram.com/remoteworkingindonesia/" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    className="text-blue-600 hover:underline"
                  >
                    üì± Instagram
                  </a>
                  <a 
                    href="https://www.threads.net/@remoteworkingindonesia" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    className="text-blue-600 hover:underline"
                  >
                    üßµ Threads
                  </a>
                </div>
              </footer>
            </div>
          </div>
        </div>
      );
    };

    // Render the application
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(
      <ErrorBoundary>
        <EmbeddableApp />
      </ErrorBoundary>
    );
  </script>

  <!-- Embedding detection and optimization -->
  <script>
    // Detect if we're being embedded and optimize accordingly
    window.addEventListener('load', function() {
      const isEmbedded = window.self !== window.top;
      
      if (isEmbedded) {
        // Add embedded-specific optimizations
        document.body.style.padding = '0.5rem';
        document.body.style.margin = '0';
        
        // Post message to parent about successful load
        try {
          parent.postMessage({
            type: 'RWI_EMBED_LOADED',
            url: window.location.href,
            timestamp: new Date().toISOString()
          }, '*');
        } catch (e) {
          // Ignore cross-origin errors
        }
      }
    });
    
    // Handle resize messages from parent
    window.addEventListener('message', function(event) {
      if (event.data.type === 'RWI_EMBED_RESIZE' && event.data.height) {
        document.body.style.height = event.data.height + 'px';
      }
    });
  </script>

  <!-- Service Worker for offline capability (optional) -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        // Register service worker for offline capability
        // This is optional and can be implemented later
      });
    }
  </script>
</body>
</html>